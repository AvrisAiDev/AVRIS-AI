import{b as N}from"./chunk-JRDKNHIA.js";import{a as k,b as D,c as V,d as $}from"./chunk-ADHIYY5J.js";import{a as h,b as O,d as T,e as u,f as _}from"./chunk-TIN3U24M.js";import{e as A}from"./chunk-SZJS6YUP.js";import{Ab as c,Cb as x,Db as M,Eb as m,F as E,Mb as I,Q as p,R as L,Va as s,_a as C,eb as g,fa as y,ga as w,ib as l,j as v,pb as S,ub as r,yb as o,zb as a}from"./chunk-5423XKIL.js";var b=class n{constructor(t){this.stateManagementService=t}contactActive;destroy$=new v;config;firstInit=!1;eventListeners=[];ngOnInit(){this.stateManagementService.platformState.pipe(h(t=>t)).pipe(p(this.destroy$)).subscribe(t=>{this.config=t}),this.stateManagementService.contactStore.pipe(u()).pipe(p(this.destroy$)).subscribe(t=>{this.contactActive=t,this.contactActive&&!this.firstInit&&(this.firstInit=!0,this.createBot(this.contactActive))})}createBot(t){let e=document.createElement("script");e.src="./botpress/inject.js",e.onload=()=>{window.botpress.on("webchat:opened",i=>{console.log("webchat:opened");let d=document.getElementsByTagName("iframe")[0];var f=document.createElement("link");f.rel="stylesheet",f.type="text/css",f.href="./theme/bot.css",d.contentDocument?.head.appendChild(f)}),this.eventListeners.push(window.botpress.on("webchat:ready",i=>{console.log("webchat:ready"),window.botpress.state!=="opened"&&window.botpress.open()})),this.eventListeners.push(window.botpress.on("messageSent",i=>{console.log("messageSent:",i)})),this.eventListeners.push(window.botpress.on("webchat:closed",i=>{console.log("webchat was closed ",i)})),this.eventListeners.push(window.botpress.on("messageSent",i=>{console.log("webchat was closed ",i)})),this.eventListeners.push(window.botpress.on("customEvent",i=>{console.log("webchat was closed ",i)})),this.eventListeners.push(window.botpress.on("message",i=>{console.log("message:",i)})),this.eventListeners.push(window.botpress.on("conversation",i=>{console.log("conversation id: ",i)})),window.botpress.init({clientId:t.clientId,botId:t.botId,selector:"#webchat",configuration:{botName:t.name,fontFamily:"inter",botAvatar:t.avatar}}),setTimeout(()=>{window.botpress.open()},500)},document.body.appendChild(e)}ngAfterViewInit(){}ngOnDestroy(){this.eventListeners.forEach(t=>t()),this.destroy$.next(!0),this.destroy$.complete()}static \u0275fac=function(e){return new(e||n)(C(_))};static \u0275cmp=g({type:n,selectors:[["app-chat-message"]],decls:2,vars:0,consts:[["id","webchat"]],template:function(e,i){e&1&&(o(0,"main"),c(1,"div",0),a())},dependencies:[A,N],styles:["main[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:100%;height:100%}main[_ngcontent-%COMP%]   #webchat[_ngcontent-%COMP%]{width:100%;height:calc(100% - 64px)}"]})};function U(n,t){if(n&1){let e=x();o(0,"div",8)(1,"div",11),M("click",function(){y(e);let d=m(2);return w(d.unSelect())}),c(2,"img",12),a(),o(3,"div",13),c(4,"app-contact",14),a()()}if(n&2){let e=m(2);s(4),S("contact",e.contactActive)}}function H(n,t){n&1&&c(0,"app-chat-message")}function R(n,t){if(n&1&&(o(0,"section",0)(1,"div",2),c(2,"app-navigation"),a(),o(3,"div",3)(4,"div",4)(5,"div",5)(6,"div",6),c(7,"img",7),o(8,"strong"),I(9,"Chat Contact"),a()(),l(10,U,5,1,"div",8),a()(),o(11,"div",9),c(12,"app-contact-list"),a(),o(13,"div",10),l(14,H,1,0,"app-chat-message"),a()()()),n&2){let e=m();s(10),r(e.contactActive?10:-1),s(4),r(e.contactActive&&e.contactActive.isOnline?14:-1)}}function q(n,t){n&1&&(o(0,"div",6)(1,"strong"),I(2,"Chat Contact"),a()())}function z(n,t){if(n&1){let e=x();o(0,"div",8)(1,"div",11),M("click",function(){y(e);let d=m(2);return w(d.unSelect())}),c(2,"img",16),a(),o(3,"div",13),c(4,"app-contact",14),a()()}if(n&2){let e=m(2);s(4),S("contact",e.contactActive)}}function G(n,t){n&1&&(o(0,"div",9),c(1,"app-contact-list"),a())}function J(n,t){n&1&&c(0,"app-chat-message")}function K(n,t){if(n&1&&(o(0,"div",10),l(1,J,1,0,"app-chat-message"),a()),n&2){let e=m(2);s(),r(e.contactActive&&e.contactActive.isOnline?1:-1)}}function Q(n,t){if(n&1&&(o(0,"section",1)(1,"div",3)(2,"div",4)(3,"div",5),l(4,q,3,0,"div",6)(5,z,5,1,"div",8),o(6,"div",15),c(7,"app-mobile-navigation"),a()()(),l(8,G,2,0,"div",9)(9,K,2,1,"div",10),a()()),n&2){let e=m();s(4),r(e.contactActive?5:4),s(4),r(e.contactActive?9:8)}}var j=class n{constructor(t){this.stateManagementService=t}destroy$=new v;config;contactActive;ngOnInit(){this.stateManagementService.platformState.pipe(h(t=>t)).subscribe(t=>{this.config=t}),this.stateManagementService.contactStore.pipe(u()).pipe(L(()=>this.contactActive=void 0),p(this.destroy$),E(500)).subscribe(t=>{this.contactActive=t}),this.stateManagementService.contactStore.update(O([{botId:"101a6530-1d8e-4701-a31a-b621dcb40e3c",clientId:"8efc82d4-4f26-4273-a1ca-736070ed4af6",name:"Paul Carrington",avatar:"./avatar/paul.png",isOnline:!0},{botId:"6e657618-925a-4ee3-b1e5-7c79e9941937",clientId:"979f843d-f352-4dfc-94d1-da4ee15e8afb",name:"Debby Halston",avatar:"./avatar/debby.png",isOnline:!0},{botId:"191db63d-4df1-4f63-8773-e8406cf04db0",clientId:"843a39c3-76a4-44f9-b096-ecf3f85c1ddb",name:"Morgan Lancaster",avatar:"./avatar/morgan.png",isOnline:!0},{botId:"191db63d-4df1-4f63-8773-e8406cf04db3",clientId:"843a39c3-76a4-44f9-b096-ecf3f85c1dd3",name:"Emma Brown",avatar:"./avatar/emma.png",isOnline:!1}]))}ngOnDestroy(){this.destroy$.next(!0),this.destroy$.complete(),this.stateManagementService.contactStore.reset()}unSelect(){this.stateManagementService.contactStore.update(T(null))}static \u0275fac=function(e){return new(e||n)(C(_))};static \u0275cmp=g({type:n,selectors:[["app-layout"]],decls:2,vars:2,consts:[[1,"desktop-layout"],[1,"mobile-layout"],[1,"navigation"],[1,"content"],[1,"header"],[1,"selected-contact"],[1,"contacts-header"],["src","./icones/chat-contact.svg","alt","",2,"width","24px"],[1,"contact-wrapper"],[1,"contacts"],[1,"message"],[1,"icon",3,"click"],["src","./icones/close.png"],[1,"contact"],[3,"contact"],[1,"mobile-navigation"],["src","./icones/back.png"]],template:function(e,i){e&1&&l(0,R,15,2,"section",0)(1,Q,10,2,"section",1),e&2&&(r(i.config&&i.config.platform==="desktop"?0:-1),s(),r(i.config&&i.config.platform==="mobile"?1:-1))},dependencies:[b,D,V,k,$],encapsulation:2})};export{j as ChatLayoutComponent};
