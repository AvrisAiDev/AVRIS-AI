import{E as M,G as g,N as D,P as m,T,a as c,b as d,f as a,g as C,j as v,k as w,l as F,n as B,o as y,s as p,z}from"./chunk-5423XKIL.js";function tt(...t){let e={config:{},state:{}};for(let{config:n,props:i}of t)Object.assign(e.config,n),Object.assign(e.state,i);return e}var N=new w(!1),et=N.asObservable().pipe(z(t=>!t),M(1));var l={},A=class{registerPreStoreUpdate(e){l.preStoreUpdate=e}registerPreStateInit(e){l.preStateInit=e}},At=new A,q=new Map,P=new v,Ot=P.asObservable();function nt(t){q.set(t.name,t),P.next({type:"add",store:t})}function it(t){q.delete(t.name),P.next({type:"remove",store:t})}var E=[];function rt(t){E.push(t)}function G(t){E.length&&E.forEach(e=>t.next(e)),E=[]}var O=class extends w{constructor(e){super(e.state),this.storeDef=e,this.initialState=void 0,this.state=void 0,this.batchInProgress=!1,this.events=new v,this.context={config:this.getConfig(),setEvent:n=>{rt(n)}},this.events$=this.events.asObservable(),this.state=this.getInitialState(e.state),this.initialState=this.getValue(),nt(this)}get name(){return this.storeDef.name}getInitialState(e){return l.preStateInit?l.preStateInit(e,this.name):e}getConfig(){return this.storeDef.config}query(e){return e(this.getValue())}update(...e){let n=this.getValue(),i=e.reduce((s,r)=>(s=r(s,this.context),s),n);l.preStoreUpdate&&(i=l.preStoreUpdate(n,i,this.name)),i!==n&&(this.state=i,N.getValue()?this.batchInProgress||(this.batchInProgress=!0,et.subscribe(()=>{super.next(this.state),G(this.events),this.batchInProgress=!1})):(super.next(this.state),G(this.events)))}getValue(){return this.state}reset(){this.update(()=>this.initialState)}combine(e){let n=!0,i={};return new C(s=>{for(let[r,o]of Object.entries(e))s.add(o.subscribe(u=>{i[r]=u,n=!0}));return this.subscribe({next(){n&&(s.next(c({},i)),n=!1)},error(r){s.error(r)},complete(){s.complete()}})})}destroy(){it(this),this.reset()}next(e){this.update(()=>e)}error(){}complete(){}};function $(t,...e){let{state:n,config:i}=tt(...e),{name:s}=t;return new O({name:s,state:n,config:i})}function I(t){return Array.isArray(t)?t:[t]}function K(t){return typeof t=="function"}function _(t){return t===void 0}function h(t){return t.charAt(0).toUpperCase()+t.slice(1)}function st(t){return typeof t=="object"&&!Array.isArray(t)&&t!==null}function j(t){return a(p(t),g())}function V(t,{initialValue:e,config:n}){let i=e,s=h(t);return{[`with${s}`](r=i){return{props:{[t]:r},config:n}},[`set${s}InitialValue`](r){i=r},[`set${s}`](r){return function(o){let u=K(r)?r(o):r;return u===o[t]?o:d(c({},o),{[t]:u})}},[`update${s}`](r){return function(o){let u=K(r)?r(o):r;return u===o[t]?o:d(c({},o),{[t]:st(u)?c(c({},o[t]),u):u})}},[`reset${s}`](){return function(r){return d(c({},r),{[t]:i})}},[`select${s}`](){return j(r=>r[t])},[`get${s}`](r){return r[t]}}}function J(t,e){let n=h(t),i=V(t,e);return d(c({},i),{[`add${n}`](s){return function(r){return d(c({},r),{[t]:ot(r[t],s)})}},[`remove${n}`](s){return function(r){return d(c({},r),{[t]:ct(r[t],s)})}},[`toggle${n}`](s){return function(r){return d(c({},r),{[t]:ut(r[t],s)})}},[`update${n}`](s,r){return function(o){return d(c({},o),{[t]:dt(o[t],s,r)})}},[`in${n}`](s){return r=>ft(r[t],s)}})}function ot(t,e){return[...t,...I(e)]}function ct(t,e){let n=I(e);return t.filter(i=>!n.includes(i))}function ut(t,e){let n=I(e),i=[...t];return n.forEach(s=>{let r=i.indexOf(s);r>-1?i.splice(r,1):i.push(s)}),i}function ft(t,e){return t.includes(e)}function dt(t,e,n){return t.map(i=>i===e?n:i)}function L(t){return{props:t,config:void 0}}function H(t,e){let n={},i=[];for(let s of t){let r=s[e];i.push(r),n[r]=s}return{ids:i,asObject:n}}function at(t,e){return t&&e?K(e)?e(t):t[e]:t}function lt(t,e){return t.config[e.idKeyRef]}var R=class{constructor(e){this.entitiesKey=void 0,this.idsKey=void 0,this.idKeyRef="idKey",this.entitiesKey=e.entitiesKey,this.idsKey=e.idsKey,this.idKeyRef=e.idKeyRef}};function W(t){let e=t?`idKey${h(t)}`:"idKey",n=new R({entitiesKey:t?`${t}Entities`:"entities",idsKey:t?`${t}Ids`:"ids",idKeyRef:e});function i(s){let r={},o=[],u=s?.idKey||"id";return s?.initialValue&&({ids:o,asObject:r}=H(s.initialValue,u)),{props:{[n.entitiesKey]:r,[n.idsKey]:o},config:{[e]:u}}}return{[`${t}EntitiesRef`]:n,[`with${h(t)}Entities`]:i}}var{withEntities:Q,EntitiesRef:b}=W(""),{UIEntitiesRef:Ft,withUIEntities:Bt}=W("UI");function zt(t,e={}){return function(n,i){let{ref:s=b}=e,{entitiesKey:r,idsKey:o}=s,{ids:u,asObject:f}=H(t,lt(i,s));return i.setEvent({type:"set",ids:u}),d(c({},n),{[r]:f,[o]:u})}}function X(t){return g((e,n)=>e[t]===n[t])}function Mt(t={}){let{ref:{entitiesKey:e,idsKey:n}=b}=t;return a(X(e),p(i=>i[n].map(s=>i[e][s])))}function yt(t,e={}){let{ref:{entitiesKey:n}=b,pluck:i}=e;return a(X(n),j(s=>pt(s[n],t,i)))}function pt(t,e,n){let i=t[e];if(!_(i))return n?at(i,n):i}var{selectActiveId:ht,setActiveId:Dt,withActiveId:Y,resetActiveId:Tt,getActiveId:Gt}=V("activeId",{initialValue:void 0});function Nt(t={}){let{ref:e=b}=t;return function(n){return n.pipe(ht()).pipe(m(i=>n.pipe(yt(i,{ref:e}))))}}var{setActiveIds:qt,resetActiveIds:_t,withActiveIds:Jt,selectActiveIds:Lt,toggleActiveIds:Ht,removeActiveIds:Wt,addActiveIds:Qt,getActiveIds:Xt}=J("activeIds",{initialValue:[]});function U(t,e){let n={source:f=>f,preStoreInit:f=>f,key:e.key??`${t.name}@store`,runGuard(){return typeof window<"u"}},i=c(c({},n),e);if(!i.runGuard?.())return{initialized$:y(!1),unsubscribe(){}};let{storage:s}=e,r=new F(1),o=B(s.getItem(i.key)).subscribe(f=>{f&&t.update(S=>i.preStoreInit(c(c({},S),f))),r.next(!0),r.complete()}),u=i.source(t).pipe(D(1),m(f=>{let S=i.preStorageUpdate?i.preStorageUpdate(t.name,f):f;return s.setItem(i.key,S)})).subscribe();return{initialized$:r.asObservable(),unsubscribe(){u.unsubscribe(),o.unsubscribe()}}}function Z(t){if(t)return{getItem(e){let n=t.getItem(e);return y(n&&JSON.parse(n))},setItem(e,n){return t.setItem(e,JSON.stringify(n)),y(!0)},removeItem(e){return t.removeItem(e),y(!0)}}}var gt=()=>{try{if(typeof localStorage<"u")return localStorage}catch{}},ee=Z(gt()),mt=()=>{try{if(typeof sessionStorage<"u")return sessionStorage}catch{}},x=Z(mt());var k=class t{contactStore=$({name:"contactStore"},Q({idKey:"botId"}),Y());platformState=$({name:"platform"},L({platform:"desktop",theme:"dark"}));constructor(){U(this.contactStore,{key:"contactStore",storage:x}),U(this.platformState,{key:"platform",storage:x})}static \u0275fac=function(n){return new(n||t)};static \u0275prov=T({token:t,factory:t.\u0275fac,providedIn:"root"})};export{j as a,zt as b,Mt as c,Dt as d,Nt as e,k as f};
